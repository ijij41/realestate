{%  extends "pages/base.html" %}


{% block head-css %}
    <!-- DataTables CSS -->
    <link href="/static/vendor/datatables-plugins/dataTables.bootstrap.css" rel="stylesheet">

    <!-- DataTables Responsive CSS -->
    <link href="/static/vendor/datatables-responsive/dataTables.responsive.css" rel="stylesheet">

{% endblock %}

{% block head-custom-js %}


<script type="text/javaScript">

	// through jquery, communication to server in background. In addtion, we use ajax as library.

	$(function() {

            /**
			$.ajax({
				url : "../ajax/get_address_do/si/0/",
				success : function(data) {
					loadCombo($("#{{ form.si_code.auto_id }}"), data.data);
					$("#{{ form.si_code.auto_id }}").val("");
				},
				error : function(request,status,error){
					alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
				}
			});**/


            //// initialize ////////////////////////////////////////////////////////////////////////////////////////////////////
            $("#{{ form.si_code.auto_id }}").val(11);   //서울특별시

            before_year = current_year() - 1;
            if(before_year<2006){
                before_year=2006;
            }
            /**
            alert(before_year);
            alert(current_year());
            alert(current_quarter());
             **/
            $("#{{ form.start_year.auto_id }}").val(before_year);
            $("#{{ form.start_quarter.auto_id }}").val(current_quarter());
            $("#{{ form.end_year.auto_id }}").val(current_year());
            $("#{{ form.end_quarter.auto_id }}").val(current_quarter());
            ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////

			$("#{{ form.si_code.auto_id }}").change(function() {   //call this function. when si code is changed
				$.ajax({
					url : "../ajax/get_address_do/gu/"+$("#{{ form.si_code.auto_id }} option:selected").val(),
					success : function(data) {
						loadCombo($("#{{ form.gu_code.auto_id }}"), data.data);
						//$("#{{ form.gu_code.auto_id }}").val("");
					},
					error : function(request,status,error){
						alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
					}
				});

			});


			$("#{{ form.gu_code.auto_id }}").change(function() {  //call this function. when gu code combi is changed
				$.ajax({
					url : "../ajax/get_address_do/dong/"+$("#{{ form.gu_code.auto_id }} option:selected").val(),
					success : function(data) {
						loadCombo($("#{{ form.dong_code.auto_id }}"), data.data);
						//$("#{{ form.dong_code.auto_id }}").val("");
					},
					error : function(request,status,error){
						alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
					}
				});

			});






/**
			$("#form_address").submit(function(e) {     // call this function when form is submitted
				//alert('getdata');
				//val datas = $(this).serialize();
				//var datas=$(this).serialize();
				//alert(datas);
				//$('#result_from_search').text(datas);
				var selected_code=$("#combobox_dong option:selected").val();
				//alert(selected_code);
				$.ajax({
					//method : "POST",
					url : "../ajax/getDataAjaxdo/"+selected_code,
					//data : $(this).serialize(),l
					success : function(data) {
						//a+lert(data);
						var obj = $.parseJSON(data.return_data)
						//alert(data.return_data);
						//alert(obj);
						addOnData(obj);

					},
					error : function(request,status,error){
						alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
					}
				});

				e.preventDefault();
				//echo('aa');
			});
 **/


	});


/**
	function addOnData(data) {
		//alert('in addon data');
		//alert(data);
		$(data).each( function() {
			//alert('xxx');
			var dongcode = this.fields.dongcode;
			var bldg_nm = this.fields.bldg_nm;
			//alert("aa"):
			$("#result_from_search").append("<div>"+dongcode+" , "+bldg_nm+"</div>");
		});
	}
**/
</script>


{% endblock %}

{% block page %}

    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">Tables</h1>
        </div>
        <!-- /.col-lg-12 -->
    </div>

    <div class="col-lg-12">

        <div class="panel panel-default">

            <!-- panel-heading -->
            <div class="panel-heading">
                <label>검색조건</label>
                <div class="panel-body">
{#                    TODO name driven from djnago#}
                    <form action="." method = "post" name="search_form">{% csrf_token %}
                            <!--div class="col-lg-5"-->
                                <div class="form-group">
                                {{ form.as_table }}
                                </div>
                                <button type="button" class="btn btn-primary" onclick="search_form.submit();">조회</button>
                            <!--/div-->
                            <!--a href="javascript:login.submit();" class="btn btn-lg btn-success btn-block">Login</a>
                            <input type="submit" value="submit"-->
                       </form>
                </div>

            </div>
            <!-- /.panel-heading -->


            <!-- panel-body -->
            <div class="panel-body">


                <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
                    <thead>
                    <tr>
                        <th>주택유형</th>
                        <th>거래타입</th>
                        <th>거래시기</th>
                        <th>주소</th>
                        <th>면적</th>
                        <th>층</th>
                        <th>이름</th>
                        <th>건축년도</th>
                        <th>보증금</th>
                        <th>월세</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% if object_list %}
                        {% for deal in object_list %}
                            <tr class="odd gradeX">

                                <td>{{ deal.get_housetype }}</td>
                                <td>{{ deal.get_dealtype }}</td>
                                <td>{{ deal.year }}년/{{ deal.period }}분기 - {{ deal.deal_date }}</td>
                                <td>{{ deal.address.si_name }} &nbsp {{ deal.address.gu_name }} &nbsp {{ deal.address.dong_name }}</td>
                                <td> {{ deal.bldg_area }}&#13217</td>
                                <td> {{ deal.aptfno }}</td>
                                <td> {{ deal.bldg_nm }}</td>
                                <td> {{ deal.build_year }}</td>
                                <td> {{ deal.sum_amt }}</td>
                                {% if deal.dealtype == '2' %}
                                <td> {{ deal.rent_amt }}</td>
                                {% else %}
                                <td> </td>
                                {% endif %}
                            </tr>
                            {#                            #}
                            {#                            housetype = models.CharField(db_column='houseType', max_length=1)  # Field name made lowercase.#}
                            {#    dealtype = models.CharField(db_column='dealType', max_length=1)  # Field name made lowercase.#}
                            {##}
                            {#    year = models.IntegerField(db_column='Year')  # Field name made lowercase.#}
                            {#    period = models.IntegerField(db_column='Period')  # Field name made lowercase.#}
                            {##}
                            {#    sidocode = models.IntegerField(db_column='sidoCode')  # Field name made lowercase.#}
                            {#    guguncode = models.IntegerField(db_column='gugunCode')  # Field name made lowercase.#}
                            {#    dongcode = models.BigIntegerField(db_column='dongCode')  # Field name made lowercase.#}
                            {##}
                            {#    deal_date = models.DateField(db_column='deal_data')#}
                            {##}
                            {#    bldg_area = models.FloatField(db_column='BLDG_AREA', blank=True, null=True)  # Field name made lowercase.#}
                            {#    bobn = models.CharField(db_column='BOBN', max_length=11, blank=True, null=True)  # Field name made lowercase.#}
                            {#    aptfno = models.CharField(db_column='APTFNO', max_length=25, blank=True, null=True)  # Field name made lowercase.#}
                            {#    deal_dd = models.CharField(db_column='DEAL_DD', max_length=11, blank=True, null=True)  # Field name made lowercase.#}
                            {#    deal_mm = models.IntegerField(db_column='DEAL_MM', blank=True, null=True)  # Field name made lowercase.#}
                            {#    bldg_nm = models.CharField(db_column='BLDG_NM', max_length=100, blank=True, null=True)  # Field name made lowercase.#}
                            {#    bubn = models.CharField(db_column='BUBN', max_length=100, blank=True, null=True)  # Field name made lowercase.#}
                            {#    bldg_cd = models.BigIntegerField(db_column='BLDG_CD', blank=True, null=True)  # Field name made lowercase.#}
                            {#    build_year = models.IntegerField(db_column='BUILD_YEAR', blank=True, null=True)  # Field name made lowercase.#}
                            {#    sum_amt = models.IntegerField(db_column='SUM_AMT', blank=True, null=True)  # Field name made lowercase.#}
                            {#    rent_amt = models.IntegerField(db_column='RENT_AMT', blank=True, null=True)  # Field name made lowercase.#}
                            {#    tot_area = models.FloatField(db_column='TOT_AREA', blank=True, null=True)  # Field name made lowercase.#}
                            {#    bldg_muse_nm = models.CharField(db_column='BLDG_MUSE_NM', max_length=40, blank=True,#}
                            {#                                    null=True)  # Field name made lowercase.#}
                            {#    lawd_cd = models.BigIntegerField(db_column='LAWD_CD', blank=True, null=True)  # Field name made lowercase.#}
                            {#    umd_nm = models.CharField(db_column='UMD_NM', max_length=40, blank=True, null=True)  # Field name made lowercase.#}
                            {#    right_gbn = models.IntegerField(db_column='RIGHT_GBN', blank=True, null=True)  # Field name made lowercase.#}
                            {##}
                            {##}
                            {##}
                            {#                    <tr class="odd gradeX">#}
                            {#                        <td>Trident</td>#}
                            {#                        <td>Internet Explorer 4.0</td>#}
                            {#                        <td>Win 95+</td>#}
                            {#                        <td class="center">4</td>#}
                            {#                        <td class="center">X</td>#}
                            {#                    </tr>#}
                            {#                    <tr class="even gradeC">#}
                            {#                        <td>Trident</td>#}
                            {#                        <td>Internet Explorer 5.0</td>#}
                            {#                        <td>Win 95+</td>#}
                            {#                        <td class="center">5</td>#}
                            {#                        <td class="center">C</td>#}
                            {#                    </tr>#}

                        {% endfor %}
                    {% else %}
                        <tr class="odd">
                                <td class="dataTables_empty" colspan="10" valign="top">No data available in table</td>
                        </tr>
                    {% endif %}
                    </tbody>
                </table>
                <!-- /.table-responsive -->

                <div class="row">
                    <div class="col-sm-6">
                        <div id="dataTables-example_info" class="dataTables_info" role="status" aria-live="polite">
                            Showing 1 to 2 of 2 entries
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div id="dataTables-example_paginate" class="dataTables_paginate paging_simple_numbers">
                            <ul class="pagination">
                                <li id="dataTables-example_previous" class="paginate_button previous disabled"
                                    aria-controls="dataTables-example" tabindex="0">
                                    <a href="#">Previous</a>
                                </li>
                                <li class="paginate_button active" aria-controls="dataTables-example" tabindex="0">
                                    <a href="#">1</a>
                                </li>
                                <li id="dataTables-example_next" class="paginate_button next disabled"
                                    aria-controls="dataTables-example" tabindex="0">
                                    <a href="#">Next</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- /.paginate -->

            </div>
            <!-- /.panel-body -->



        </div>
        <!-- /.end of panel panel-default -->
    </div>
    <!-- /.col-lg-12 -->



{% endblock %}

{% block bottom-custom-js %}

    <!-- DataTables JavaScript -->
    <script src="/static/vendor/datatables/js/jquery.dataTables.min.js"></script>
    <script src="/static/vendor/datatables-plugins/dataTables.bootstrap.min.js"></script>
    <script src="/static/vendor/datatables-responsive/dataTables.responsive.js"></script>

    <!-- Page-Level Demo Scripts - Tables - Use for reference -->
    <!--script>
    $(document).ready(function() {
        $('#dataTables-example').DataTable({
            responsive: true
        });
    });
    </script-->

{% endblock %}

